# ğŸ³ Recipe Recommender System
**CSC 577 â€” Recommender Systems | Winter 2026**  
**Team Rocket** â€” Mohammed Ahmed Hussain, Sameer Ahmed Noor, Drishti Arora  
**Instructor:** Bamshad Mobasher, DePaul University

---

## Overview

A hybrid recipe recommender system built on the [Food.com Recipes & Interactions dataset](https://www.kaggle.com/datasets/shuyangli94/food-com-recipes-and-user-interactions/data). The system recommends personalized recipes based on a user's historical ratings and filters results by ingredient availability and dietary preferences.

Two collaborative filtering models are implemented **from scratch** (no recommendation libraries):
- **User-Based CF** â€” cosine similarity between mean-centered user rating vectors
- **SVD** â€” truncated matrix factorization using `scipy.sparse.linalg.svds`

Both are layered with an ingredient constraint system supporting hard filtering (0 missing ingredients) and soft filtering (allow up to N missing), plus dietary restriction presets (Halal, vegetarian, vegan, gluten-free, dairy-free).

---

## Project Structure

```
Recipe-Recommender/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ RAW_recipes.csv              â† Download from Kaggle
â”‚   â”œâ”€â”€ RAW_interactions.csv         â† Download from Kaggle
â”‚   â””â”€â”€ processed/                   â† Auto-generated by notebooks
â”‚       â”œâ”€â”€ interactions_clean.csv
â”‚       â”œâ”€â”€ recipes_clean.csv
â”‚       â”œâ”€â”€ train.csv
â”‚       â”œâ”€â”€ test.csv
â”‚       â”œâ”€â”€ test_with_predictions.csv
â”‚       â”œâ”€â”€ cf_ubased_candidates.csv
â”‚       â”œâ”€â”€ cf_svd_candidates.csv
â”‚       â”œâ”€â”€ constrained_ubcf_hard.csv
â”‚       â”œâ”€â”€ constrained_ubcf_soft.csv
â”‚       â”œâ”€â”€ constrained_svd_hard.csv
â”‚       â”œâ”€â”€ constrained_svd_soft.csv
â”‚       â”œâ”€â”€ user_mapping.csv
â”‚       â””â”€â”€ recipe_mapping.csv
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_EDA.ipynb                 â† Exploratory data analysis
â”‚   â”œâ”€â”€ 02_preprocessing.ipynb       â† Cleaning, filtering, saving processed data
â”‚   â”œâ”€â”€ 03_collaborative_filtering.ipynb  â† UB-CF and SVD models
â”‚   â”œâ”€â”€ 04_constraint_filtering.ipynb     â† Ingredient constraint layer
â”‚   â””â”€â”€ 05_evaluation.ipynb          â† RMSE, MAE, Precision@K, Recall@K, CSR
â”‚
â”œâ”€â”€ results/                         â† Auto-generated plots and metrics
â”‚   â”œâ”€â”€ rating_distribution.png
â”‚   â”œâ”€â”€ user_activity.png
â”‚   â”œâ”€â”€ recipe_popularity.png
â”‚   â”œâ”€â”€ ingredient_analysis.png
â”‚   â”œâ”€â”€ tag_analysis.png
â”‚   â”œâ”€â”€ cooking_time.png
â”‚   â”œâ”€â”€ avg_recipe_ratings.png
â”‚   â”œâ”€â”€ svd_variance.png
â”‚   â”œâ”€â”€ precision_recall_at_k.png
â”‚   â”œâ”€â”€ rmse_mae.png
â”‚   â”œâ”€â”€ csr_comparison.png
â”‚   â”œâ”€â”€ tradeoff_precision_csr.png
â”‚   â”œâ”€â”€ metrics_heatmap.png
â”‚   â””â”€â”€ metrics_comparison.csv
â”‚
â”œâ”€â”€ app.py                           â† Streamlit web UI
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## Setup

### 1. Clone / download the project

```bash
git clone <your-repo-url>
cd Recipe-Recommender
```

### 2. Install dependencies

```bash
pip install -r requirements.txt
```

Or if `pip` isn't on your PATH (Windows):

```bash
python -m pip install -r requirements.txt
```

### 3. Download the dataset

Download from Kaggle: [Food.com Recipes and Interactions](https://www.kaggle.com/datasets/shuyangli94/food-com-recipes-and-user-interactions/data)

Place these two files in the `data/` folder:
- `RAW_recipes.csv`
- `RAW_interactions.csv`

---

## Running the Notebooks

Run in order â€” each notebook saves output files that the next one depends on.

```
01_EDA.ipynb  â†’  02_preprocessing.ipynb  â†’  03_collaborative_filtering.ipynb
â†’  04_constraint_filtering.ipynb  â†’  05_evaluation.ipynb
```

| Notebook | Purpose | Key Outputs |
|---|---|---|
| `01_EDA.ipynb` | Explore raw data, understand distributions | Plots saved to `results/` |
| `02_preprocessing.ipynb` | Clean, filter, parse, save | `data/processed/interactions_clean.csv`, `recipes_clean.csv` |
| `03_collaborative_filtering.ipynb` | Build UB-CF and SVD models | `cf_ubased_candidates.csv`, `cf_svd_candidates.csv`, `test_with_predictions.csv` |
| `04_constraint_filtering.ipynb` | Apply ingredient constraints | `constrained_ubcf_hard.csv`, `constrained_ubcf_soft.csv`, `constrained_svd_hard.csv`, `constrained_svd_soft.csv` |
| `05_evaluation.ipynb` | Compute and compare all metrics | `results/metrics_comparison.csv`, all metric plots |

---

## Running the Web App

After running at least notebooks 01 and 02 (so that processed data exists):

```bash
python -m streamlit run app.py
```

Open your browser to `http://localhost:8501`

> **Note:** The app builds the CF models on first launch (may take 1â€“2 minutes). They are cached for the rest of the session.

---

## App Features

### Tab 1 â€” By Ingredients
- Search and select ingredients from a dropdown (sourced from the full dataset)
- Quick preset pantries: Chicken & Basics, Vegetarian, Seafood, Baking, Slow Cook
- Dietary restriction checkboxes â€” filter out unwanted ingredients before recommending:

| Restriction | Removes |
|---|---|
| ğŸ¥© No Pork (Halal-friendly) | pork, bacon, ham, lard, chorizo, sausage, pepperoni, etc. |
| ğŸ„ No Red Meat | beef, lamb, veal, steak, brisket, ground beef, etc. |
| ğŸŒ± Vegetarian | all meat and seafood |
| ğŸŒ¿ Vegan | all meat, seafood, dairy, eggs, honey |
| ğŸŒ¾ Gluten-Free | flour, wheat, pasta, breadcrumbs, soy sauce, etc. |
| ğŸ¥› Dairy-Free | milk, butter, cheese, cream, yogurt, etc. |

### Tab 2 â€” By User ID
- Enter any user ID from the dataset
- Pick from a dropdown of the 10 most active users
- Shows user stats (number of recipes rated, average rating)

### Sidebar Controls (apply to both tabs)
- Switch between **SVD** and **User-Based CF**
- Ingredient constraint mode: **None** / **Hard (0 missing)** / **Soft (allow up to N missing)**
- Adjust max missing ingredients (soft mode)
- Adjust number of recipes to display (5â€“20)

---

## Algorithms

### User-Based Collaborative Filtering

1. Build a sparse user Ã— recipe rating matrix from training interactions
2. Mean-center each user's ratings to correct for rating scale bias
3. Compute pairwise cosine similarity between all users (vectorized)
4. For a target user, predict ratings using a weighted average of similar users' mean-centered ratings:

$$\hat{r}_{ui} = \bar{r}_u + \frac{\sum_{v \in N(u)} sim(u,v) \cdot (r_{vi} - \bar{r}_v)}{\sum_{v \in N(u)} |sim(u,v)|}$$

5. Rank unseen recipes by predicted rating

### SVD Matrix Factorization

1. Decompose the mean-centered matrix using truncated SVD: R â‰ˆ U Â· Î£ Â· Váµ€ (k=50 latent factors)
2. Reconstruct predictions per user: $\hat{r}_u = \mathbf{u}_u \cdot \Sigma \cdot V^T + \bar{r}_u$
3. Rank unseen recipes by predicted rating

Both models compute predictions **per user on demand** (no full matrix materialisation) to stay within memory limits on large datasets.

### Ingredient Constraint Layer

Applied on top of CF candidate lists:

- **Hard constraint:** keep only recipes where `|recipe_ingredients âˆ’ user_pantry| = 0`
- **Soft constraint:** keep recipes where `|recipe_ingredients âˆ’ user_pantry| â‰¤ max_missing`, re-ranked by `(n_missing ASC, predicted_rating DESC)`

---

## Evaluation Metrics

| Metric | Description |
|---|---|
| **RMSE** | Root mean squared error of predicted vs actual ratings on held-out test set |
| **MAE** | Mean absolute error of predicted vs actual ratings |
| **Precision@K** | Fraction of top-K recommendations that the user actually rated â‰¥ 4 |
| **Recall@K** | Fraction of all liked recipes (rated â‰¥ 4) that appear in the top-K |
| **CSR** | Constraint Satisfaction Rate â€” % of recommendations that satisfy the ingredient filter |

Six systems are compared: UB-CF, SVD, UB-CF + Hard, UB-CF + Soft, SVD + Hard, SVD + Soft.

---

## Dataset

**Food.com Recipes & Interactions** (via Kaggle)

| File | Rows | Description |
|---|---|---|
| `RAW_recipes.csv` | ~180,000 | Recipe metadata: name, ingredients, tags, nutrition, cook time |
| `RAW_interactions.csv` | ~700,000 | User ratings (1â€“5) and reviews |

After preprocessing (min 10 ratings/user, min 5 ratings/recipe, remove zero ratings):

| | Value |
|---|---|
| Users | ~9,000 |
| Recipes | ~37,000 |
| Ratings | ~300,000+ |
| Matrix sparsity | >99% |

---

## Requirements

```
streamlit>=1.32.0
pandas>=2.0.0
numpy>=1.24.0
scipy>=1.11.0
scikit-learn>=1.3.0
matplotlib>=3.7.0
seaborn>=0.12.0
```

---

## Academic Integrity

This project was developed for CSC 577 at DePaul University. All recommendation algorithms are implemented from scratch using only numpy and scipy â€” no recommendation libraries (e.g. Surprise) were used. All third-party data sources are credited above.
